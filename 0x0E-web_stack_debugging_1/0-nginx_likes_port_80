#!/bin/bash

# Check if Nginx is running
nginx_status=$(service nginx status)
if [[ $nginx_status =~ "active (running)" ]]; then
    echo "Nginx is already running."
else
    echo "Nginx is not running. Starting Nginx..."
    service nginx start
fi

# Check if Nginx is listening on port 80
if ! nc -z localhost 80; then
    echo "Nginx is not listening on port 80. Running the fix script..."
    ./0-nginx_likes_port_80 > /dev/null 2>&1
    if ! nc -z localhost 80; then
        echo "The fix script did not successfully configure Nginx to listen on port 80."
        exit 1
    fi
fi

echo "Nginx is now configured to listen on port 80."

